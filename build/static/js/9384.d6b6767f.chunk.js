"use strict";(self.webpackChunkmantis_material_react=self.webpackChunkmantis_material_react||[]).push([[9384],{99384:function(e,i,t){t.r(i),t.d(i,{default:function(){return I}});var s=t(47313),n=t(71325),r=t(85554),l=t(51305),d=t(88298),o=t(2244),a=t(1413),c=t(29439),u=t(19860),x=t(56104),m=t(42832),Z=t(61113),h=t(69099),p=t(9019),j=t(15103),b=t(24631),g=t(83882),f=t(15480),v=t(19536),P=t(89688),k=t(97133),S=t(16366),T=t(35604),E=t(56462),F=t(41366),q=t(21933),w=t(90967),_=t(58467),y=t(46417),C=function(){var e=(0,r.I0)(),i=(0,u.Z)(),t=(0,_.s0)(),l=(0,r.v9)((function(e){return e.location.disctricts})).districtsTab,C=(0,r.v9)((function(e){return e.checkpoint.detail})).checkpoint,I=(0,r.v9)((function(e){return e.checkpoint.create})).createStatus,A=(0,s.useState)([]),R=(0,c.Z)(A,2),z=R[0],J=R[1],V=(0,s.useState)([]),W=(0,c.Z)(V,2),B=W[0],L=W[1];(0,s.useEffect)((function(){J(C.users),L(C.animals)}),[C]);var M=q.Ry({name:q.Z_().required((0,y.jsx)(n.Z,{id:"checkpoint-name-required"})).matches(/^[a-zA-Z0-9\s]*[a-zA-Z][a-zA-Z0-9\s]*$/,(0,y.jsx)(n.Z,{id:"checkpoint-name-characters"})),district:q.Ry().required((0,y.jsx)(n.Z,{id:"district-required"})),latitude:q.Rx().positive((0,y.jsx)(n.Z,{id:"latitude-positive"})).required((0,y.jsx)(n.Z,{id:"latitude-required"})),longitude:q.Rx().positive((0,y.jsx)(n.Z,{id:"longitude-positive"})).required((0,y.jsx)(n.Z,{id:"longitude-required"})),responsable:q.Z_().when("userTab",{is:function(e){return e&&e.length>0&&e.some((function(e){return!0===e.isR}))},then:q.Z_().required((0,y.jsx)(n.Z,{id:"responsable-required"}))})}),O=(0,T.TA)({initialValues:{name:null===C||void 0===C?void 0:C.libelle,district:null===C||void 0===C?void 0:C.district[0],latitude:null===C||void 0===C?void 0:C.latitude,longitude:null===C||void 0===C?void 0:C.longitude,responsable:C.users.find((function(e){return 1==e.responsable})).username,animalTabs:null===C||void 0===C?void 0:C.animals,userTab:null===C||void 0===C?void 0:C.users},onSubmit:function(i){if(0!==z.length)if(z.length<2)O.setErrors({submit:(0,y.jsx)(n.Z,{id:"agents-tab-min-required"})});else if(0!==B.length)if(z.some((function(e){return e.username===i.responsable})))if(B.every((function(e){return parseFloat(e.max_animal)>0}))){var t=z.map(F.S5),s=B.map(F.F7);e((0,w.Sc)({pk:C.id,animals:s,libelle:i.name,latitude:i.latitude,longitude:i.longitude,users:t,id_district:O.values.district?O.values.district.pk:null}))}else O.setErrors({submit:(0,y.jsx)(n.Z,{id:"animals-limit"})});else O.setErrors({responsable:(0,y.jsx)(n.Z,{id:"responsable-not-found"})});else O.setErrors({submit:(0,y.jsx)(n.Z,{id:"animals-tab-required"})});else O.setErrors({submit:(0,y.jsx)(n.Z,{id:"agents-tab-required"})})},validationSchema:M});if((0,s.useEffect)((function(){O.setErrors({submit:void 0})}),[z,B]),I==d.J_.loading)return(0,y.jsx)(o.Z,{id:(0,y.jsx)(n.Z,{id:"loading"})});var D=O.handleSubmit,H=O.getFieldProps,N=O.setStatus,$=O.setSubmitting,G=O.errors,K=O.touched,Q=O.setErrors,U=O.resetForm;return(0,y.jsxs)(P.Z,{content:!1,sx:{overflow:"visible"},children:[(0,y.jsx)(x.Z,{sx:{position:"sticky",top:"60px",bgcolor:i.palette.background.default,zIndex:1,borderBottom:"1px solid ".concat(i.palette.divider)},children:(0,y.jsxs)(m.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{width:1},children:[(0,y.jsx)(Z.Z,{variant:"h5",sx:{m:0,pl:1.5},children:(0,y.jsx)(n.Z,{id:"new-checkpoint"})}),(0,y.jsxs)(m.Z,{direction:"row",spacing:1,sx:{px:1.5,py:.75},children:[(0,y.jsx)(h.Z,{color:"error",size:"small",onClick:function(){return t("/apps/checkpoints/list/")},children:(0,y.jsx)(n.Z,{id:"cancel"})}),(0,y.jsx)(h.Z,{variant:"contained",size:"small",onClick:O.handleSubmit,children:(0,y.jsx)(n.Z,{id:"submit"})})]})]})}),(0,y.jsx)(T.Hy,{value:O,children:(0,y.jsxs)(T.l0,{autoComplete:"off",noValidate:!0,onSubmit:D,children:[(0,y.jsx)(Z.Z,{variant:"h5",component:"div",sx:{p:3},children:(0,y.jsx)(n.Z,{id:"general-info"})}),(0,y.jsxs)(p.ZP,{container:!0,spacing:3,sx:{p:5},children:[(0,y.jsx)(p.ZP,{item:!0,xs:12,md:12,children:(0,y.jsxs)(p.ZP,{container:!0,spacing:3,children:[(0,y.jsx)(p.ZP,{item:!0,xs:12,md:6,children:(0,y.jsxs)(m.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,y.jsx)(p.ZP,{item:!0,xs:5,children:(0,y.jsx)(j.Z,{htmlFor:"name",children:(0,y.jsx)(n.Z,{id:"name"})})}),(0,y.jsx)(p.ZP,{item:!0,xs:15,children:(0,y.jsx)(b.Z,(0,a.Z)((0,a.Z)({fullWidth:!0,id:"name",placeholder:"Enter Checkpoint Name"},H("name")),{},{error:Boolean(K.name&&G.name),helperText:K.name&&G.name}))})]})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,md:6,children:(0,y.jsxs)(m.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,y.jsx)(p.ZP,{item:!0,xs:4,children:(0,y.jsx)(j.Z,{htmlFor:"district",children:(0,y.jsx)(n.Z,{id:"district"})})}),(0,y.jsxs)(p.ZP,{item:!0,xs:12,children:[(0,y.jsx)(g.Z,{id:"district",value:O.values.district,onChange:function(e,i){O.setFieldValue("district",i)},getOptionLabel:function(e){return e.name},options:l,isOptionEqualToValue:function(e,i){return e.pk===i.pk},renderInput:function(e){return(0,y.jsx)(b.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Select District",sx:{"& .MuiAutocomplete-input.Mui-disabled":{WebkitTextFillColor:i.palette.text.primary}}}))}}),O.touched.district&&O.errors.district&&(0,y.jsx)(f.Z,{error:!0,id:"helper-text-district",children:O.errors.district})]})]})})]})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,md:12,children:(0,y.jsxs)(p.ZP,{container:!0,spacing:3,children:[(0,y.jsx)(p.ZP,{item:!0,xs:12,md:6,children:(0,y.jsxs)(m.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,y.jsx)(p.ZP,{item:!0,xs:5,children:(0,y.jsx)(j.Z,{htmlFor:"latitude",children:(0,y.jsx)(n.Z,{id:"latitude"})})}),(0,y.jsx)(p.ZP,{item:!0,xs:15,children:(0,y.jsx)(b.Z,(0,a.Z)((0,a.Z)({fullWidth:!0,id:"latitude",type:"number",placeholder:"Enter Latitude"},H("latitude")),{},{error:Boolean(K.latitude&&G.latitude),helperText:K.latitude&&G.latitude}))})]})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,md:6,children:(0,y.jsxs)(m.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,y.jsx)(p.ZP,{item:!0,xs:5,children:(0,y.jsx)(j.Z,{htmlFor:"longitude",children:(0,y.jsx)(n.Z,{id:"longitute"})})}),(0,y.jsx)(p.ZP,{item:!0,xs:15,children:(0,y.jsx)(b.Z,(0,a.Z)((0,a.Z)({fullWidth:!0,id:"longitude",type:"number",placeholder:"Enter Longitude"},H("longitude")),{},{error:Boolean(K.longitude&&G.longitude),helperText:K.longitude&&G.longitude}))})]})})]})})]}),(0,y.jsx)(v.Z,{}),(0,y.jsx)(Z.Z,{variant:"h5",component:"div",sx:{p:3},children:(0,y.jsx)(n.Z,{id:"configuration"})}),(0,y.jsxs)(p.ZP,{container:!0,spacing:3,sx:{p:5},children:[G.submit&&(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(f.Z,{error:!0,children:G.submit})}),(null===z||void 0===z?void 0:z.length)>0&&(0,y.jsx)(p.ZP,{item:!0,xs:12,md:6,children:(0,y.jsxs)(m.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,y.jsx)(p.ZP,{item:!0,xs:4,children:(0,y.jsx)(j.Z,{htmlFor:"responsable",children:(0,y.jsx)(n.Z,{id:"responsable"})})}),(0,y.jsxs)(p.ZP,{item:!0,xs:12,children:[(0,y.jsx)(g.Z,{id:"responsable",value:O.values.responsable,onChange:function(e,i){var t=z.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{isR:e.username===i})}));J(t),O.setFieldValue("responsable",i)},options:z.map((function(e){return e.username})),getOptionLabel:function(e){return e},renderInput:function(e){return(0,y.jsx)(b.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Select Responsable",sx:{"& .MuiAutocomplete-input.Mui-disabled":{WebkitTextFillColor:i.palette.text.primary}}}))}}),O.touched.responsable&&O.errors.responsable&&(0,y.jsx)(f.Z,{error:!0,id:"helper-text-responsable",children:O.errors.responsable})]})]})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,md:12,children:(0,y.jsxs)(p.ZP,{container:!0,spacing:3,children:[(0,y.jsx)(p.ZP,{item:!0,xs:12,md:6,children:(0,y.jsx)(k.Z,{selectedTab:z,setSelectedTab:J})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,md:6,children:(0,y.jsx)(S.Z,{selectedTab:B,setSelectedTab:L,setFormikAnimalTabs:O.setFieldValue,formik:O})})]})})]}),(0,y.jsx)(E.Z,{resetForm:U,setErrors:Q,setStatus:N,setSubmitting:$})]})})]})},I=function(){var e=(0,r.I0)(),i=(0,r.v9)((function(e){return e.location.disctricts})),t=i.listStatus,a=i.districtsTab,c=(0,r.v9)((function(e){return e.checkpoint.detail})),u=c.detailStatus,x=c.detailError,m=(0,r.v9)((function(e){return e.checkpoint.edit})).editStatus;return(0,s.useEffect)((function(){e((0,l.J)())}),[]),u==d.J_.loading||m==d.J_.loading?(0,y.jsx)(o.Z,{title:(0,y.jsx)(n.Z,{id:"loading"})}):(console.log(u,t),t!=d.J_.error&&0!=a.length||(o.Z,n.Z),u==d.J_.error?(0,y.jsx)(o.Z,{id:x}):(0,y.jsx)(C,{}))}}}]);